<p align = "center">
  <img src="https://user-images.githubusercontent.com/128324837/229282750-acca6c03-96d2-4c50-add9-df97ae2e7f77.png" width=60% height=60%>
</p>

# Formula 1 Data Exploration

## 1. Background and Motivation
<p align = "justify"> Formula One (F1) is one of the most exciting and high-profile sports in the world, with a global fan base of millions. The sport's popularity is fueled by its high-speed, adrenaline-fueled action, as well as its history and prestige. F1 racing involves cutting-edge technology, precision engineering, and world-class drivers, all of which come together to create a thrilling and unpredictable spectacle. 
    </p>
  
<p align = "justify"> In recent years, the F1 world has seen a surge in the amount of data generated by the sport. From telemetry data to race results, there is a wealth of information available that can be used to gain insights into the sport and help teams and drivers optimize their performance.
    </p>

<p align = "justify"> This project aims to conduct a comprehensive analysis of F1 data using SQL to answer several research questions. To achieve this, a large and diverse dataset that contains historical data on F1 races, teams, drivers, and track conditions will be leveraged and SQL queries will be used to extract relevant data from the database, transform it into meaningful insights, and visualize the results to facilitate interpretation and communication. his project will also involve cleaning and organizing the data to ensure it is in a format that can be easily analyzed
     </p>

<p align = "justify"> The insights generated from this project could be useful for a wide range of stakeholders in the F1 ecosystem, including teams, drivers, sponsors, and fans. By understanding the factors that contribute to success in F1, teams and drivers can make data-driven decisions to improve their performance and gain a competitive edge. Sponsors could use the insights to identify potential opportunities for branding and marketing, while fans could gain a deeper appreciation and understanding of the sport they love.
    </p>

<p align = "justify"> Overall, this project aims to provide valuable insights into the performance of F1 teams and drivers and advance our understanding of the factors that contribute to success in the sport. By leveraging the power of big data and SQL, we can unlock hidden patterns and trends in the data that can inform decision-making and enhance our appreciation of this thrilling sport.
  </p>

## 2. Research Questions
I have chosen the following reseach questions to focus on in this project:

1. Which constructor teams are the most successful in terms of total races entered and total points earned?
2. Which drivers are the most successful in terms of total points and wins?
3. Which country produces the most world champions?
4. Does higher altitude cause more engine failures in Formula 1 races?

## 3. Dataset: Data Retrieval and Standard Descriptive Analysis

The dataset used in the project is available at: [https://www.kaggle.com/cjgdev/formula-1-race-data-19502017](https://www.kaggle.com/datasets/rohanrao/formula-1-world-championship-1950-2020)

It contains race entries from 1950 to present. 

The dataset includes:

1. **circuits.csv:** This file contains data on all the circuits that have hosted a Formula 1 race.
2. **constructor_results.csv:** This file contains data on the race results for each constructor.
3. **constructor_standings.csv:** This file contains data on the final constructor standings for each season.
4. **constructors.csv:** This file contains data on each constructor that has participated in Formula 1.
5. **driver_standings.csv:** This file contains data on the final driver standings for each season.
6. **drivers.csv:** This file contains data on each driver that has participated in Formula 1.
7. **lap_times.csv:** This file contains data on the lap times for each driver in each race.
8. **pit_stops.csv:** This file contains data on the pit stops made by each driver in each race.
9. **qualifying.csv:** This file contains data on the qualifying sessions for each race.
10. **races.csv:** This file contains data on each race, including the race's ID.
11. **results.csv:** This file contains data on the results of each race.
12. **seasons.csv:** This file contains data on each season of Formula 1.
13. **status.csv:** This file contains information about the status codes that can be assigned to a driver's car during a race.

## 5. Import the Data to SQL
The next is step is to create tables and import the data into mySQL

```sql 

# 1: Circuits
CREATE TABLE circuits (
    circuitId integer,
    circuitRef varchar(255),
    name varchar(255),
    location varchar(255),
    country varchar(255),
    lat integer,
    lng integer,
    alt integer,
	url varchar(255)
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/circuits.csv'
INTO TABLE circuits
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM circuits;
# 2: Lap Times
CREATE TABLE lap_times (
    raceId integer,
	driverId integer,
    lap integer,
    position integer,
    time time,
    milliseconds integer
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/lap_times.csv'
INTO TABLE lap_times
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM lap_times;

# 3: Pit Stops
CREATE TABLE pit_stops (
    raceId integer,
	driverId integer,
    stop integer,
    lap integer,
    time time,
    milliseconds integer,
    duration time
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/pit_stops.csv'
INTO TABLE pit_stops
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM pit_stops;

# 4: Seasons
CREATE TABLE seasons (
    year varchar(255),
    url varchar(255)
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/seasons.csv'
INTO TABLE seasons
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM seasons;

# 5: Status
CREATE TABLE status (
    statusId integer,
    status varchar(255)
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/status.csv'
INTO TABLE status
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM status;

# 6: Constructor Standings
CREATE TABLE constructor_standings (
	constructorStandingId integer,
    raceId integer,
    constructorId integer,
    points integer,
    position integer,
    positionText varchar(255),
    wins integer
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/constructor_standings.csv'
INTO TABLE constructor_standings
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM constructor_standings;

# 7: Constructors
CREATE TABLE constructors (
	constructorId integer,
    constructorRef varchar(255),
    name varchar(255),
    nationality varchar(255),
    url varchar(255)
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/constructors.csv'
INTO TABLE constructors
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM constructors;

# 8: Driver Standings
CREATE TABLE driver_standings (
	driverStandingId integer,
    raceId integer,
    driverId integer,
    points integer,
    position integer,
    positionText varchar(255),
    wins integer
    );

LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/driver_standings.csv'
INTO TABLE driver_standings
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM driver_standings;

# 9: Drivers
CREATE TABLE drivers (
	driverId integer,
    driverRef varchar(255),
    forename varchar(255),
    surname varchar(255),
    dob date,
    nationality varchar(255),
    url varchar(255)
    );

LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/drivers.csv'
INTO TABLE drivers
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM drivers;

# 10: Races
CREATE TABLE races(
	raceId integer,
    year varchar(255),
    round integer,
    circuitId integer,
    name varchar(255),
    date date,
    time time,
    url varchar(255)
    );

LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/races.csv'
INTO TABLE races
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM races;

# 11: Constructor Results
CREATE TABLE constructor_results (
	constructorResultsId integer,
    raceId integer,
    constructorId integer,
    points integer
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/constructor_results.csv'
INTO TABLE constructor_results
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM constructor_results;

# 12: Results
CREATE TABLE results (
	resultsId integer,
    raceId integer,
    driverId integer,
    constructorId integer,
    number integer,
    grid integer,
    position integer,
    positionText varchar(255),
    positionOrder integer,
    points integer,
    laps integer,
    time time,
    milliseconds integer,
    fastestLap integer,
    ranks integer,
    fastestLapTime decimal(10,3),
    fastestSpeed integer,
    statusId integer
    );
    
LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula1/Data/Cleaned/results.csv'
INTO TABLE results
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM results;

# 13: Qualifying
CREATE TABLE qualifying (
	qualifyId integer,
    raceId integer,
    driverId integer,
    constructorId integer,
    number integer,
    position integer,
	q1 time,
    q2 time,
    q3 time
    );

LOAD DATA LOCAL INFILE '/Users/elizabeth/Documents/GitHub/Formula 1/Data/Cleaned/qualifying.csv'
INTO TABLE qualifying
FIELDS TERMINATED BY ','
IGNORE 1 ROWS;

SELECT *
FROM qualifying;
```
## 6. Analyzing Data to Find the Most Successful Constructors
Join results table and constructors table:
``` sql
SELECT *
FROM results r
JOIN constructors c
ON r.constructorId = c.constructorId;
```
### 6.1 Find the Constructor Who Has Entered the Most Races
Exact columns needed to find total races entered by constructors:
``` sql
SELECT c.name, COUNT(DISTINCT r.raceId) AS total_races
FROM results r
JOIN constructors c
ON r.constructorId = c.constructorId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of query

| name       | total_races |
|------------|-------------|
| Ferrari    | 1054        |
| McLaren    | 883         |
| Williams   | 797         |
| Tyrrell    | 433         |
| Renault    | 403         |
| Sauber     | 395         |
| Team Lotus | 395         |
| Red Bull   | 348         |
| Minardi    | 345         |
| Ligier     | 330         |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229288014-8c27c80c-86b1-451e-92ef-a075a7e1221d.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The table and barchart show the number of races entered by the top 10 constructor teams in Formula 1 history. Ferrari is the most successful constructor with a total of 1054 races entered, followed by McLaren with 883 races and Williams with 797 races. Tyrrell, Renault, Sauber, and Team Lotus have all entered over 300 races, while Red Bull, Minardi, and Ligier complete the top 10 with over 300 races entered as well. This table provides insight into the longevity and success of these teams in the history of Formula 1.</p>

### 6.2 Find the Constructor Who Has Earn the Most Points in F1 History
Exact columns needed to find total points earned by constructors:
``` sql
SELECT c.name, SUM(r.points) AS total_points
FROM results r
JOIN constructors c
ON r.constructorId = c.constructorId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of Query
| name        | total_points |
|-------------|--------------|
| Ferrari     | 10138        |
| Mercedes    | 6924         |
| Red Bull    | 6347         |
| McLaren     | 6149         |
| Williams    | 3599         |
| Renault     | 1777         |
| Force India | 1098         |
| Team Lotus  | 995          |
| Benetton    | 862          |
| Tyrrell     | 711          |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229288803-536288a7-f0d3-4cf9-9bf8-f3cc7ab6272d.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The above table and barchart show the total points earned by different Formula 1 constructor teams throughout their history in the sport. Points are awarded based on a team's performance in each race, with the team scoring the most points at the end of the season being declared the Constructors' Champion. From the table it is clear that Ferrari is the team that has earned the most points in the history of F1, with 10138.  Mercedes is seconds with 6924 points.</p>
<p align = "justify">
It is impressive that Mercedes is so high on the list because they have only been competing as a works team in Formula 1 since 2010, but in that time they have become one of the most dominant teams in the sport's history. They have won the Constructors' Championship in every season from 2014 to 2021. This sustained period of success has allowed them to accumulate a significant number of points in a relatively short period of time, which is reflected in their high ranking on this table.</p>

### 6.3 Find the Highest Average Points Earned Per Race by Constructors Who Have Entered at Least 100 Races
``` sql
SELECT c.name, ROUND(SUM(r.points)/COUNT(DISTINCT r.raceId),2) AS points_per_race
FROM results r
JOIN constructors c
ON r.constructorId = c.constructorId
GROUP BY 1
HAVING COUNT(DISTINCT r.raceId) >=100
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of Query
| name        | points_per_race |
|-------------|-----------------|
| Mercedes    | 25.55           |
| Red Bull    | 18.24           |
| Ferrari     | 9.62            |
| McLaren     | 6.96            |
| Force India | 5.18            |
| Williams    | 4.52            |
| Renault     | 4.41            |
| Benetton    | 3.32            |
| BRM         | 2.59            |
| Team Lotus  | 2.52            |

From the table it is clear that on average Mercedes scores the most amount of points per race at 25.55. From this table and the following visualization, it is clear why Mercedes are the team with the second most points every, even after being in the sport for only a relatively short time.

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229291997-5432ecc2-951f-4555-a5e9-e7a02d18555e.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The table and barchart show the average points per race for each Formula One team. It is impressive to see that Mercedes tops the list with a points per race average of 25.55, which is more than double the second-place team, Red Bull, with 18.24. This indicates that Mercedes has been consistently successful in scoring points across races.</p>
<p align = "justify">
It's interesting to note that the former Force India team, now racing as Aston Martin, has a higher points per race average than Williams and Renault, despite not having as long of a history in the sport. Overall, the table indicates the dominance of Mercedes in recent years, as well as the consistency and success of Red Bull and Ferrari.</p>

## 7. Analyzing Data to Find the Most Successful Drivers
Join results table and drivers table:
``` sql
SELECT *
FROM results r
JOIN drivers d
ON r.driverId = d.driverId;
```

### 7.1 Find the Driver Who Has Entered the Most Races

Exact columns needed to find total races entered by drivers:
``` sql
SELECT d.surname, COUNT(DISTINCT r.raceId) AS total_races
FROM results r
JOIN drivers d
ON r.driverId = d.driverId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of Query
| surname     | total_races |
|-------------|-------------|
| Schumacher  | 375         |
| Alonso      | 358         |
| Räikkönen   | 352         |
| Rosberg     | 334         |
| Barrichello | 326         |
| Hamilton    | 315         |
| Button      | 309         |
| Hill        | 303         |
| Vettel      | 300         |
| Massa       | 271         |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229294013-22cdb9b4-ae45-48a3-a195-853a5e574c05.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The table and barchart show the top 10 drivers with the highest number of total races in Formula 1. At the top of the list is Michael Schumacher with 375 races, followed closely by Fernando Alonso with 358 races and Kimi Räikkönen with 352 races.</p>
<p align = "justify">
It's worth noting that despite their impressive number of races, some of these drivers have not won a world championship. For example, Barrichello has the highest number of races (326) without ever winning a championship. Button also raced in 309 Grand Prix races, but only managed to win one championship. Hill, who comes in at number eight on the list, won one championship in his 303 race career.</p>
<p align = "justify">
Overall, this table highlights the longevity and consistency of some of the most successful drivers in Formula 1 history.</p>

### 7.2 Find the Driver Who Has Earn the Most Points in F1 History
Exact columns needed to find total points earned by drivers:
``` sql
SELECT d.surname, SUM(r.points) AS total_points
FROM results r
JOIN drivers d
ON r.driverId = d.driverId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of Query
| surname    | total_points |
|------------|--------------|
| Hamilton   | 4397         |
| Vettel     | 3098         |
| Alonso     | 2061         |
| Verstappen | 2001         |
| Schumacher | 1907         |
| Räikkönen  | 1873         |
| Bottas     | 1778         |
| Rosberg    | 1755         |
| Ricciardo  | 1307         |
| Button     | 1235         |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229294669-1f405ca0-25eb-4ffc-8bc4-6250bd6b50a8.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The table and bar chart show the total points earned by the top 10 Formula 1 drivers of all time. It is important to note that the points system in Formula 1 has changed over the years, so it is not entirely fair to compare the points earned by drivers from different eras. However, it is clear from the table that Lewis Hamilton is the most successful driver in terms of total points earned, with a staggering 4397 points to his name.</p>
<p align = "justify">
It is interesting to note that the points per race have increased over the years due to various rule changes, including the introduction of double points for the final race of the season in 2014. This means that drivers who have raced in more recent seasons have had more opportunities to earn points, and as a result, they may appear higher on this list than drivers from earlier eras.</p>

### 7.3 Find the Highest Average Points Earned Per Race by Drivers Who Have Entered at Least 50 Races
``` sql
SELECT d.surname, ROUND(SUM(r.points)/COUNT(DISTINCT r.raceId),2) AS points_per_race
FROM results r
JOIN drivers d
ON r.driverId = d.driverId
GROUP BY 1
HAVING COUNT(DISTINCT r.raceId) >=50
ORDER BY 2 DESC
LIMIT 10;
```

#### -- Result of Query
| surname     | points_per_race |
|-------------|-----------------|
| Hamilton    | 13.96           |
| Vettel      | 10.33           |
| Bottas      | 8.85            |
| Leclerc     | 8.26            |
| Verstappen  | 7.41            |
| Alonso      | 5.76            |
| Ricciardo   | 5.63            |
| Fangio      | 5.49            |
| Räikkönen   | 5.32            |
| Rosberg     | 5.25            |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229296101-6da6ef8c-a10a-4cab-9a20-6451507d3fd4.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
The table and chart show the average number of points scored per race for each driver, based on their career statistics. The points per race metric is a useful way to compare drivers' performance, as it takes into account both the number of races a driver has competed in and the number of points they have scored.</p>
<p align = "justify">
It is notable that Lewis Hamilton has the highest average points per race among all the drivers, with a score of 13.96. This is a reflection of his consistent performance over the years, as well as his ability to win races and score podium finishes. Sebastian Vettel and Valtteri Bottas also have impressive scores of 10.33 and 8.85, respectively.</p>
<p align = "justify">
Interestingly, some of the greatest drivers in Formula 1 history, such as Alain Prost and Ayrton Senna, do not appear in the top 10 in terms of points per race. This is likely because they competed in an era where fewer points were awarded for each race, and there were fewer races overall in the season. It also highlights the importance of context when interpreting statistics in Formula 1.</p>

### 7.4 Find the Driver Who has Won the Most World Championships
Group drivers by nationality, year and surname to get the max points achieved every season
``` sql
SELECT d.surname, d.nationality, r.year, MAX(ds.points) AS total_points, MAX(ds.wins) AS total_wins
FROM drivers d
JOIN driver_standings ds
ON d.driverId = ds.driverId
JOIN races r
ON ds.raceId = r.raceId
GROUP BY 1,2,3
ORDER BY 4 DESC;
```
Use the the max points achieved every season to find the world champion for every year
``` sql
SELECT DISTINCT r.year, d.nationality, d.surname, ds.points
FROM drivers d
JOIN driver_standings ds
ON d.driverId = ds.driverId
JOIN races r
ON ds.raceId = r.raceId
WHERE (r.year, ds.points) IN (
	SELECT r.year, MAX(ds.points)
	FROM drivers d
    JOIN driver_standings ds
	ON d.driverId = ds.driverId
	JOIN races r
	ON ds.raceId = r.raceId
	GROUP BY 1
)
AND ds.points <> 0 
ORDER BY 1 DESC;
```
Find the drivers with the most world championships
``` sql
SELECT d.surname, COUNT(DISTINCT r.year) AS total_championships
FROM drivers d
JOIN driver_standings ds
ON d.driverId = ds.driverId
JOIN races r
ON ds.raceId = r.raceId
WHERE (r.year, ds.points) IN (
	SELECT r.year, MAX(ds.points)
	FROM drivers d
    JOIN driver_standings ds
	ON d.driverId = ds.driverId
	JOIN races r
	ON ds.raceId = r.raceId
	GROUP BY 1
)
AND ds.points <> 0
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
#### -- Result of Query
| surname    | total_championships |
|------------|---------------------|
| Schumacher | 7                   |
| Hamilton   | 7                   |
| Fangio     | 5                   |
| Prost      | 4                   |
| Vettel     | 4                   |
| Hill       | 4                   |
| Senna      | 3                   |
| Piquet     | 3                   |
| Brabham    | 3                   |
| Stewart    | 3                   |

#### -- Visualization of Data
<p align = "center">
<img src="https://user-images.githubusercontent.com/128324837/229297916-50863d2d-63ed-46e5-8d0b-305b46fb3675.png" width=60% height=60%> </p>

#### -- Discussion of Data and Results
<p align = "justify">
This table and chart show the total number of world championships won by the top 10 drivers. The world championship is awarded to the driver who accumulates the most points over the course of a Formula One season.</p>
<p align = "justify">
The fact that Michael Schumacher and Lewis Hamilton are tied for the most championships at 7 each is particularly impressive, as it demonstrates their exceptional talent and longevity in the sport. Both drivers have dominated their respective eras and set numerous records, cementing their status as two of the greatest drivers in the history of Formula One.</p>









### Methods Implemented 
This project contains implementations of scientific methods such as: 
- Data Wrangling
- Data Integration & Data Enrichment
- Linear Regression
